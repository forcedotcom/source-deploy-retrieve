name: perf-scale-nuts
on:
  workflow_call:

jobs:
  perf-scale-nuts:
    strategy:
      matrix:
        # os: ['ubuntu-latest', 'windows-latest']
        os: ['windows-latest']
    runs-on: ${{ matrix.os }}
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: latest
      - run: npm install -g sfdx-cli --omit=dev
      - run: git config --global push.default current
      - run: git config --global user.email alm-cli@salesforce.com
      - run: git config user.name SF-CLI-BOT
      - run: yarn install
      - run: yarn build
      - run: yarn test:nuts:scale
      - run: git status
      - run: git add test/nuts/perfResults
      - run: 'git commit -m "test: record perf [ci skip]" --no-verify'
      - run: git push --no-verify
